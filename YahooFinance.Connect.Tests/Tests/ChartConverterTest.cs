using Newtonsoft.Json;
using Xunit;
using YahooFinance.Connect.Infrastructure;
using YahooFinance.Connect.Models;

namespace YahooFinance.Connect.Tests.Tests
{
    public class ChartConverterTest
    {
        [Fact]
        public void Test()
        {
            var jsonData = @"{
  ""chart"": {
    ""result"": [
      {
        ""meta"": {
          ""currency"": ""USD"",
          ""symbol"": ""GME"",
          ""exchangeName"": ""NYQ"",
          ""instrumentType"": ""EQUITY"",
          ""firstTradeDate"": 1013610600,
          ""regularMarketTime"": 1614978002,
          ""gmtoffset"": -18000,
          ""timezone"": ""EST"",
          ""exchangeTimezoneName"": ""America/New_York"",
          ""regularMarketPrice"": 137.74,
          ""chartPreviousClose"": 31.23,
          ""priceHint"": 2,
          ""currentTradingPeriod"": {
            ""pre"": {
              ""timezone"": ""EST"",
              ""start"": 1614934800,
              ""end"": 1614954600,
              ""gmtoffset"": -18000
            },
            ""regular"": {
              ""timezone"": ""EST"",
              ""start"": 1614954600,
              ""end"": 1614978000,
              ""gmtoffset"": -18000
            },
            ""post"": {
              ""timezone"": ""EST"",
              ""start"": 1614978000,
              ""end"": 1614992400,
              ""gmtoffset"": -18000
            }
          },
          ""dataGranularity"": ""1mo"",
          ""range"": ""5y"",
          ""validRanges"": [
            ""1d"",
            ""5d"",
            ""1mo"",
            ""3mo"",
            ""6mo"",
            ""1y"",
            ""2y"",
            ""5y"",
            ""10y"",
            ""ytd"",
            ""max""
          ]
        },
        ""timestamp"": [
          1459483200,
          1462075200,
          1464753600,
          1467345600,
          1470024000,
          1472702400,
          1475294400,
          1477972800,
          1480568400,
          1483246800,
          1485925200,
          1488344400,
          1491019200,
          1493611200,
          1496289600,
          1498881600,
          1501560000,
          1504238400,
          1506830400,
          1509508800,
          1512104400,
          1514782800,
          1517461200,
          1519880400,
          1522555200,
          1525147200,
          1527825600,
          1530417600,
          1533096000,
          1535774400,
          1538366400,
          1541044800,
          1543640400,
          1546318800,
          1548997200,
          1551416400,
          1554091200,
          1556683200,
          1559361600,
          1561953600,
          1564632000,
          1567310400,
          1569902400,
          1572580800,
          1575176400,
          1577854800,
          1580533200,
          1583038800,
          1585713600,
          1588305600,
          1590984000,
          1593576000,
          1596254400,
          1598932800,
          1601524800,
          1604203200,
          1606798800,
          1609477200,
          1612155600,
          1614574800,
          1614978002
        ],
        ""indicators"": {
          ""quote"": [
            {
              ""low"": [
                29.0,
                27.520000457763672,
                25.18000030517578,
                25.729999542236328,
                28.270000457763672,
                26.690000534057617,
                23.690000534057617,
                20.100000381469727,
                24.1299991607666,
                22.270000457763672,
                23.56999969482422,
                20.239999771118164,
                21.559999465942383,
                21.25,
                20.260000228881836,
                20.649999618530273,
                18.469999313354492,
                18.559999465942383,
                18.59000015258789,
                15.850000381469727,
                17.940000534057617,
                16.610000610351562,
                15.100000381469727,
                12.199999809265137,
                12.5,
                12.260000228881836,
                12.699999809265137,
                14.0,
                13.180000305175781,
                13.079999923706055,
                13.640000343322754,
                12.140000343322754,
                11.5600004196167,
                11.100000381469727,
                11.0,
                10.069999694824219,
                8.529999732971191,
                7.320000171661377,
                4.710000038146973,
                3.9000000953674316,
                3.1500000953674316,
                3.6600000858306885,
                4.960000038146973,
                5.349999904632568,
                5.179999828338623,
                3.8299999237060547,
                3.180000066757202,
                3.390000104904175,
                2.569999933242798,
                3.9600000381469727,
                4.019999980926514,
                3.7699999809265137,
                4.0,
                5.869999885559082,
                9.100000381469727,
                10.5,
                12.140000343322754,
                17.079999923706055,
                38.5,
                99.97000122070312,
                127.5
              ],
              ""close"": [
                32.79999923706055,
                29.100000381469727,
                26.579999923706055,
                30.950000762939453,
                28.389999389648438,
                27.59000015258789,
                24.049999237060547,
                24.690000534057617,
                25.260000228881836,
                24.489999771118164,
                24.440000534057617,
                22.549999237060547,
                22.690000534057617,
                22.139999389648438,
                21.610000610351562,
                21.690000534057617,
                18.5,
                20.65999984741211,
                18.690000534057617,
                18.75,
                17.950000762939453,
                16.809999465942383,
                15.6899995803833,
                12.619999885559082,
                13.649999618530273,
                13.199999809265137,
                14.569999694824219,
                14.40999984741211,
                13.270000457763672,
                15.270000457763672,
                14.600000381469727,
                13.65999984741211,
                12.619999885559082,
                11.34000015258789,
                11.699999809265137,
                10.15999984741211,
                8.649999618530273,
                7.579999923706055,
                5.46999979019165,
                4.019999980926514,
                3.9700000286102295,
                5.519999980926514,
                5.440000057220459,
                6.340000152587891,
                6.079999923706055,
                3.8399999141693115,
                3.5999999046325684,
                3.5,
                5.730000019073486,
                4.059999942779541,
                4.340000152587891,
                4.010000228881836,
                6.679999828338623,
                10.199999809265137,
                10.470000267028809,
                16.559999465942383,
                18.84000015258789,
                325.0,
                101.73999786376953,
                137.74000549316406,
                137.74000549316406
              ],
              ""volume"": [
                66957500,
                70071200,
                54733100,
                58500900,
                69658400,
                41148800,
                51545000,
                70835700,
                42751600,
                61272600,
                40738100,
                86583400,
                48114500,
                76113200,
                55700500,
                35477000,
                71639100,
                40379400,
                38113700,
                106949300,
                57876300,
                89774500,
                65241500,
                103280400,
                94335400,
                98517700,
                154989300,
                52105500,
                84426000,
                75143300,
                52300700,
                84572300,
                50159500,
                107231700,
                54706400,
                67208800,
                114515000,
                67421700,
                170303900,
                154982200,
                150910000,
                209391900,
                105171700,
                56925700,
                121013800,
                81070500,
                55790000,
                100476400,
                99735200,
                53528000,
                100281700,
                55497200,
                117270800,
                254864200,
                359871700,
                161490800,
                251301800,
                1262090400,
                826663500,
                165545200,
                30555486
              ],
              ""high"": [
                33.720001220703125,
                32.86000061035156,
                29.31999969482422,
                31.850000381469727,
                32.66999816894531,
                28.670000076293945,
                27.860000610351562,
                26.489999771118164,
                26.850000381469727,
                26.049999237060547,
                26.68000030517578,
                25.31999969482422,
                23.979999542236328,
                25.309999465942383,
                22.959999084472656,
                22.0,
                22.3700008392334,
                20.969999313354492,
                20.68000030517578,
                19.690000534057617,
                19.860000610351562,
                20.309999465942383,
                17.010000228881836,
                16.229999542236328,
                14.180000305175781,
                13.890000343322754,
                15.979999542236328,
                15.630000114440918,
                17.270000457763672,
                17.040000915527344,
                15.600000381469727,
                15.760000228881836,
                14.109999656677246,
                16.899999618530273,
                11.930000305175781,
                12.100000381469727,
                10.420000076293945,
                8.989999771118164,
                7.849999904632568,
                5.639999866485596,
                4.360000133514404,
                5.639999866485596,
                6.619999885559082,
                6.389999866485596,
                6.920000076293945,
                6.46999979019165,
                4.510000228881836,
                5.090000152587891,
                6.46999979019165,
                6.179999828338623,
                5.53000020980835,
                4.550000190734863,
                7.150000095367432,
                11.170000076293945,
                15.869999885559082,
                19.420000076293945,
                22.350000381469727,
                483.0,
                322.0,
                151.52999877929688,
                151.52999877929688
              ],
              ""open"": [
                31.729999542236328,
                32.810001373291016,
                29.020000457763672,
                26.8799991607666,
                30.969999313354492,
                28.469999313354492,
                27.59000015258789,
                24.010000228881836,
                24.65999984741211,
                25.440000534057617,
                24.489999771118164,
                24.56999969482422,
                22.520000457763672,
                22.770000457763672,
                22.149999618530273,
                21.770000457763672,
                21.690000534057617,
                18.600000381469727,
                20.649999618530273,
                18.670000076293945,
                18.729999542236328,
                17.959999084472656,
                16.700000762939453,
                15.789999961853027,
                12.510000228881836,
                13.579999923706055,
                12.800000190734863,
                14.59000015258789,
                14.420000076293945,
                13.170000076293945,
                15.279999732971191,
                14.609999656677246,
                13.819999694824219,
                12.449999809265137,
                11.3100004196167,
                11.880000114440918,
                10.289999961853027,
                8.65999984741211,
                7.579999923706055,
                5.53000020980835,
                4.019999980926514,
                3.9700000286102295,
                5.639999866485596,
                5.449999809265137,
                6.349999904632568,
                6.139999866485596,
                3.880000114440918,
                3.5999999046325684,
                3.450000047683716,
                5.650000095367432,
                4.119999885559082,
                4.309999942779541,
                4.03000020980835,
                7.300000190734863,
                10.09000015258789,
                10.819999694824219,
                17.110000610351562,
                19.0,
                316.55999755859375,
                104.54000091552734,
                128.1699981689453
              ]
            }
          ],
          ""adjclose"": [
            {
              ""adjclose"": [
                25.603662490844727,
                22.715444564819336,
                20.748336791992188,
                24.475868225097656,
                22.45136833190918,
                21.818714141845703,
                19.270538330078125,
                19.783349990844727,
                20.542285919189453,
                19.916095733642578,
                19.875436782836914,
                18.338424682617188,
                18.73708152770996,
                18.28289794921875,
                17.845230102539062,
                18.21664810180664,
                15.537482261657715,
                17.351587295532227,
                16.01165771484375,
                16.06306266784668,
                15.683008193969727,
                14.686983108520508,
                13.708433151245117,
                11.026158332824707,
                12.216769218444824,
                11.814017295837402,
                13.040169715881348,
                13.243318557739258,
                12.19561767578125,
                14.03369140625,
                13.72865104675293,
                12.84475040435791,
                11.866820335388184,
                10.967875480651855,
                11.316061973571777,
                9.826597213745117,
                8.649999618530273,
                7.579999923706055,
                5.46999979019165,
                4.019999980926514,
                3.9700000286102295,
                5.519999980926514,
                5.440000057220459,
                6.340000152587891,
                6.079999923706055,
                3.8399999141693115,
                3.5999999046325684,
                3.5,
                5.730000019073486,
                4.059999942779541,
                4.340000152587891,
                4.010000228881836,
                6.679999828338623,
                10.199999809265137,
                10.470000267028809,
                16.559999465942383,
                18.84000015258789,
                325.0,
                101.73999786376953,
                137.74000549316406,
                137.74000549316406
              ]
            }
          ]
        }
      }
    ],
    ""error"": null
  }
}";

            var data = JsonConvert.DeserializeObject<QuoteHeader>(jsonData, new ChartConverter());
        }
    }
}
